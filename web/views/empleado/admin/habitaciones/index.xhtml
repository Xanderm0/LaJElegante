<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Habitaciones</title>
     <h:outputStylesheet library="bootstrap" name="css/bootstrap.min.css" />
</h:head>

<h:body>

    <h1>Listado de Habitaciones</h1>

    <p:dataTable value="#{habitacionBean.lista}" var="hab" paginator="true" rows="10"
                 style="width:100%" tableStyleClass="table table-striped">

        <p:column headerText="#">
            #{hab.idHabitacion}
        </p:column>

        <p:column headerText="Número">
            #{hab.numero}
        </p:column>

        <p:column headerText="Tipo">
            #{hab.tipo.nombre}
        </p:column>

        <p:column headerText="Estado">
            #{hab.estado}
        </p:column>

        <p:column headerText="Acciones">

            <!-- Abrir modal de edición -->
            <p:commandButton value="Editar" icon="pi pi-pencil"
                             update=":formDialog"
                             oncomplete="PF('dlgEditar').show()"
                             actionListener="#{habitacionBean.cargarEdicion(hab)}"
                             styleClass="ui-button-warning" />

            <!-- Confirmación de eliminar -->
            <p:commandButton value="Eliminar"
                             icon="pi pi-trash"
                             actionListener="#{habitacionBean.eliminar(hab)}"
                             update="@form"
                             styleClass="ui-button-danger"
                             onclick="return confirm('¿Eliminar esta habitación?')" />

        </p:column>

    </p:dataTable>

    <!-- Modal de edición -->
    <p:dialog widgetVar="dlgEditar" modal="true" header="Editar Habitación" closable="false" width="450">

        <h:form id="formDialog">

            <p:panelGrid columns="2" style="width:100%">

                <p:outputLabel value="Número"/>
                <p:inputText value="#{habitacionBean.habitacionEdit.numero}" />

                <p:outputLabel value="Tipo"/>
                <p:selectOneMenu value="#{habitacionBean.habitacionEdit.tipo}">
                    <f:selectItems value="#{habitacionBean.tipos}" var="tp"
                                   itemValue="#{tp}" itemLabel="#{tp.nombre}" />
                </p:selectOneMenu>

                <p:outputLabel value="Estado"/>
                <p:selectOneMenu value="#{habitacionBean.habitacionEdit.estado}">
                    <f:selectItem itemValue="en servicio" itemLabel="En Servicio"/>
                    <f:selectItem itemValue="mantenimiento" itemLabel="Mantenimiento"/>
                    <f:selectItem itemValue="inactiva" itemLabel="Inactiva"/>
                </p:selectOneMenu>

            </p:panelGrid>

            <p:separator/>

            <p:commandButton value="Guardar cambios"
                             actionListener="#{habitacionBean.guardar}"
                             update="@form"
                             oncomplete="PF('dlgEditar').hide()" />

            <p:commandButton value="Cancelar"
                             type="button"
                             onclick="PF('dlgEditar').hide()" />

        </h:form>

    </p:dialog>
<h:outputScript library="bootstrap" name="js/bootstrap.bundle.min.js" />
</h:body>
</html>