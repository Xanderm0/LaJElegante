<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>Nueva Reserva</title>
     <h:outputStylesheet library="bootstrap" name="css/bootstrap.min.css" />
</h:head>
<h:body>
    <h2>Nueva Reserva</h2>

    <h:form id="reservaForm">
        <!-- Cliente -->
        <p:outputLabel for="cliente" value="Cliente:" />
        <p:selectOneMenu id="cliente" value="#{reservaBean.idCliente}" required="true">
            <f:selectItem itemLabel="Seleccione un cliente" itemValue="" />
            <f:selectItems value="#{reservaBean.clientes}" var="c" itemLabel="#{c.nombre}" itemValue="#{c.id}" />
        </p:selectOneMenu>

        <!-- Habitaci贸n -->
        <p:outputLabel for="habitacion" value="Habitaci贸n:" />
        <p:selectOneMenu id="habitacion" value="#{reservaBean.idHabitacion}" required="true">
            <f:selectItem itemLabel="Seleccione una habitaci贸n" itemValue="" />
            <f:selectItems value="#{reservaBean.habitaciones}" var="h" itemLabel="Habitaci贸n #{h.numero}" itemValue="#{h.id}" />
            <p:ajax listener="#{reservaBean.cargarPrecio}" update="precioNoche" />
        </p:selectOneMenu>

        <!-- Fechas -->
        <p:outputLabel for="fechaInicio" value="Fecha Inicio:" />
        <p:calendar id="fechaInicio" value="#{reservaBean.fechaInicio}" pattern="yyyy-MM-dd" required="true">
            <p:ajax event="dateSelect" listener="#{reservaBean.calcularNoches}" update="noches,precioTotal"/>
        </p:calendar>

        <p:outputLabel for="fechaFin" value="Fecha Fin:" />
        <p:calendar id="fechaFin" value="#{reservaBean.fechaFin}" pattern="yyyy-MM-dd" required="true">
            <p:ajax event="dateSelect" listener="#{reservaBean.calcularNoches}" update="noches,precioTotal"/>
        </p:calendar>

        <!-- Personas, Noches y Precio por Noche -->
        <p:outputLabel for="personas" value="Personas:" />
        <p:inputNumber id="personas" value="#{reservaBean.cantidadPersonas}" minValue="1">
            <p:ajax listener="#{reservaBean.validarCapacidad}" update="avisoCapacidad"/>
        </p:inputNumber>
        <h:outputText id="avisoCapacidad" value="#{reservaBean.avisoCapacidad}" style="color:red" />

        <p:outputLabel for="noches" value="Noches:" />
        <p:inputNumber id="noches" value="#{reservaBean.noches}" readonly="true" />

        <p:outputLabel for="precioNoche" value="Precio por Noche:" />
        <p:inputNumber id="precioNoche" value="#{reservaBean.precioNoche}" readonly="true" />

        <!-- Descuento y Recargo -->
        <p:outputLabel for="descuento" value="Descuento (%)" />
        <p:inputNumber id="descuento" value="#{reservaBean.descuento}" minValue="0" maxValue="100">
            <p:ajax listener="#{reservaBean.calcularPrecioTotal}" update="precioTotal"/>
        </p:inputNumber>

        <p:outputLabel for="recargo" value="Recargo (%)" />
        <p:inputNumber id="recargo" value="#{reservaBean.recargo}" minValue="0" maxValue="100">
            <p:ajax listener="#{reservaBean.calcularPrecioTotal}" update="precioTotal"/>
        </p:inputNumber>

        <!-- Precio Total -->
        <p:outputLabel for="precioTotal" value="Precio Total:" />
        <p:inputNumber id="precioTotal" value="#{reservaBean.precioTotal}" readonly="true" />

        <!-- Observaciones -->
        <p:outputLabel for="observaciones" value="Observaciones:" />
        <p:inputTextarea id="observaciones" value="#{reservaBean.observaciones}" />

        <!-- Botones -->
        <p:commandButton value="Guardar" action="#{reservaBean.guardar}" update="@form"/>
        <p:commandButton value="Cancelar" action="listarReservas.xhtml?faces-redirect=true"/>
    </h:form>
    <h:outputScript library="bootstrap" name="js/bootstrap.bundle.min.js" />
</h:body>
</html>
