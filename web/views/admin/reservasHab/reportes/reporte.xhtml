<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:head>
    <title>Reportes de Reservas</title>
</h:head>
<h:body>
    <h2>Reportes de Reservas de Habitaciones</h2>

    <h:form id="filtrosForm">

        <p:panelGrid columns="3" columnClasses="col-md-4,col-md-4,col-md-4" style="margin-bottom:20px">

            <!-- Tipo de Cliente -->
            <p:outputLabel for="tipo" value="Tipo de Cliente:" />
            <p:selectOneMenu id="tipo" value="#{reporteBean.tipoCliente}">
                <f:selectItem itemLabel="Todos" itemValue="" />
                <f:selectItems value="#{reporteBean.tipos}" var="t" itemLabel="#{t.nombre}" itemValue="#{t.id}" />
            </p:selectOneMenu>

            <!-- Desde -->
            <p:outputLabel for="desde" value="Desde:" />
            <p:calendar id="desde" value="#{reporteBean.desde}" pattern="yyyy-MM-dd" />

            <!-- Hasta -->
            <p:outputLabel for="hasta" value="Hasta:" />
            <p:calendar id="hasta" value="#{reporteBean.hasta}" pattern="yyyy-MM-dd" />

            <!-- Noches min -->
            <p:outputLabel for="nochesMin" value="Noches (mín.)" />
            <p:inputNumber id="nochesMin" value="#{reporteBean.nochesMin}" minValue="0" />

            <!-- Noches max -->
            <p:outputLabel for="nochesMax" value="Noches (máx.)" />
            <p:inputNumber id="nochesMax" value="#{reporteBean.nochesMax}" minValue="0" />

            <!-- Personas min -->
            <p:outputLabel for="personasMin" value="Personas (mín.)" />
            <p:inputNumber id="personasMin" value="#{reporteBean.personasMin}" minValue="0" />

            <!-- Personas max -->
            <p:outputLabel for="personasMax" value="Personas (máx.)" />
            <p:inputNumber id="personasMax" value="#{reporteBean.personasMax}" minValue="0" />

            <!-- Botón Filtrar -->
            <p:commandButton value="Filtrar" action="#{reporteBean.filtrar}" update="tablaReservas"/>
        </p:panelGrid>

    </h:form>

    <!-- Tabla de resultados -->
    <p:dataTable id="tablaReservas" value="#{reporteBean.reservas}" var="r" emptyMessage="No se encontraron reservas" styleClass="table table-bordered">
        <p:column headerText="Cliente">
            #{r.cliente.nombre} #{r.cliente.apellido}
        </p:column>
        <p:column headerText="Habitación">
            #{r.detalle.habitacion.numeroHabitacion}
        </p:column>
        <p:column headerText="Fechas">
            #{r.detalle.fechaInicio} - #{r.detalle.fechaFin}
        </p:column>
        <p:column headerText="Noches">
            #{r.detalle.noches}
        </p:column>
        <p:column headerText="Precio Total">
            #{r.detalle.precioReserva}
        </p:column>
        <p:column headerText="Observaciones">
            #{r.detalle.observaciones}
        </p:column>
    </p:dataTable>

    <!-- Botones Exportar -->
    <h:form>
        <p:commandButton value="Exportar a Excel" action="#{reporteBean.exportarExcel}" ajax="false" styleClass="btn btn-success"/>
        <p:commandButton value="Exportar a PDF" action="#{reporteBean.exportarPDF}" ajax="false" styleClass="btn btn-danger"/>
    </h:form>

</h:body>
</html>
